<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Bulut İndirici</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background-color: #000; color: white; font-family: -apple-system, sans-serif; }
        .glass { background: rgba(28, 28, 30, 0.8); backdrop-filter: blur(20px); border: 1px solid rgba(255, 255, 255, 0.1); }
    </style>
</head>
<body class="flex flex-col min-h-screen px-6 py-10 pt-20">
    <div class="mb-10 text-center">
        <span class="text-purple-500 font-bold text-xs tracking-widest uppercase">CLOUD SERVER</span>
        <h1 class="text-4xl font-bold mt-2">Her Yerden<br>İndirici</h1>
    </div>

    <div class="glass rounded-2xl p-1 mb-6">
        <input type="text" id="urlInput" placeholder="Link yapıştır..." class="w-full bg-transparent text-white p-4 text-lg outline-none text-center placeholder-gray-600">
    </div>

    <div class="grid grid-cols-2 gap-3 mb-8">
        <button onclick="mode='video'; updateUI()" id="btnVideo" class="bg-[#3A3A3C] py-4 rounded-xl font-bold text-sm text-white">Video</button>
        <button onclick="mode='audio'; updateUI()" id="btnAudio" class="bg-[#1C1C1E] py-4 rounded-xl font-bold text-sm text-gray-500">Ses</button>
    </div>

    <div id="status" class="hidden mb-6 text-center text-sm text-gray-400 animate-pulse">Bulut sunucusu videoyu işliyor...</div>

    <button onclick="download()" id="dlBtn" class="w-full bg-purple-600 text-white font-bold py-5 rounded-2xl text-lg shadow-lg active:scale-95 transition-transform">İNDİR</button>

    <div class="mt-auto pt-8 text-center">
        <p class="text-[10px] text-gray-600 font-medium">Powered by Cloud • @ismailsarikaya</p>
    </div>

    <script>
        let mode = 'video';
        function updateUI() {
            document.getElementById('btnVideo').className = mode==='video' ? "bg-[#3A3A3C] py-4 rounded-xl font-bold text-sm text-white border border-white/10" : "bg-[#1C1C1E] py-4 rounded-xl font-bold text-sm text-gray-500";
            document.getElementById('btnAudio').className = mode==='audio' ? "bg-[#3A3A3C] py-4 rounded-xl font-bold text-sm text-white border border-white/10" : "bg-[#1C1C1E] py-4 rounded-xl font-bold text-sm text-gray-500";
        }
        
        async function download() {
            const url = document.getElementById('urlInput').value;
            if(!url) return alert("Link yok!");
            
            document.getElementById('status').classList.remove('hidden');
            document.getElementById('dlBtn').disabled = true;
            document.getElementById('dlBtn').classList.add('opacity-50');
            
            try {
                const res = await fetch('/download', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({url, mode})
                });
                if(!res.ok) throw new Error("Hata");
                const blob = await res.blob();
                const link = document.createElement('a');
                link.href = window.URL.createObjectURL(blob);
                link.download = mode === 'video' ? 'video.mp4' : 'audio.mp3';
                link.click();
                document.getElementById('status').textContent = "✅ İndirme Başladı!";
                document.getElementById('status').classList.remove('animate-pulse', 'text-gray-400');
                document.getElementById('status').classList.add('text-green-500');
            } catch(e) {
                alert("Sunucu Hatası: Linki kontrol et.");
                document.getElementById('status').classList.add('hidden');
            }
            document.getElementById('dlBtn').disabled = false;
            document.getElementById('dlBtn').classList.remove('opacity-50');
        }
        updateUI();
    </script>
</body>
</html>
